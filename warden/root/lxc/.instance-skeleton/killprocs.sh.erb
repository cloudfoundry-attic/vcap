#!/bin/bash

# This script is a placeholder until we are no longer using lxc-tools
# and can safely kill the init process inside the container without
# destroying the associated cgroup.

for pid in `cat /dev/cgroup/instance-<%= config["id"] %>/tasks`
do
  cmdline=`cat /proc/$pid/cmdline 2>/dev/null`
  if [ "$cmdline" != "/sbin/init" ]
  then
    kill -9 $pid 2>/dev/null
  fi
done
